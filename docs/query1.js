//Get the total revenue generated by rentals grouped by car category.
import { MongoClient } from "mongodb";

const uri = "mongodb://localhost:27017" || process.env.MONGO_URI;
const client = new MongoClient(uri);

async function getRevenueByCarModel() {
  try {
      await client.connect();
      const database = client.db('carRentalManagement');
      const bookings = database.collection('Booking');

      const result = await bookings.aggregate([
        { $unwind: "$cars" },
        {
          $group: {
            _id: "$cars.model",
            totalRevenue: { $sum: "$total_cost" }
          }
        },
        { $sort: { totalRevenue: -1 } }
      ]).toArray();
  
      console.log(result);
    } finally {
      await client.close();
    }
}

getRevenueByCarModel();



